{% extends 'baseBack.html.twig' %}

{% block title %}Modifier un d√©tail d'excursion{% endblock %}

{% block body %}
<div class="container mt-5">
    <h2>Modifier le d√©tail pour : <strong>{{ excursion.titre }}</strong></h2>

    <form action="{{ path('excursion_details_update', { id: detail.id }) }}" method="post">

    {# ID excursion #}
    <input type="hidden" name="excursion_id" value="{{ excursion.id }}">

    <h4 class="mt-4">üìå D√©tail d‚Äôexcursion</h4>

    <div class="mb-3">
        <label for="titre" class="form-label">Titre</label>
        <select id="titre" name="titre" class="form-control">
            <option value="">-- Choisir un titre --</option>
            <option value="Accessibilit√©" {{ detail.titre == 'Accessibilit√©' ? 'selected' }}>Accessibilit√©</option>
            <option value="Informations suppl√©mentaires" {{ detail.titre == 'Informations suppl√©mentaires' ? 'selected' }}>Informations suppl√©mentaires</option>
            <option value="Conditions d\'annulation" {{ detail.titre == "Conditions d'annulation" ? 'selected' }}>Conditions d'annulation</option>
            <option value="Aide" {{ detail.titre == 'Aide' ? 'selected' }}>Aide</option>
            <option value="Rendez-vous et prise en charge" {{ detail.titre == 'Rendez-vous et prise en charge' ? 'selected' }}>Rendez-vous et prise en charge</option>
        </select>
    </div>

    <div class="mb-3">
        <label for="description" class="form-label">Description</label>
        <textarea id="description" name="description" class="form-control" rows="4">{{ detail.description }}</textarea>
    </div>

    <div class="mb-3">
        <label for="ordre" class="form-label">Ordre d'affichage</label>
        <input type="number" id="ordre" name="ordre" class="form-control" value="{{ detail.ordre }}" min="1">
    </div>

    <hr>

    <!-- -------------------- INCLUS EXCURSION -------------------- -->
    <h4 class="mt-4">üü¢ Inclus dans l'excursion</h4>

    <div id="zone-inclus">
        {% for inclus in inclus_list %}
            <div class="row mb-3">
                <div class="col-md-8">
                    <input type="text" name="inclus_items[]" class="form-control" value="{{ inclus.item }}">
                </div>
                <div class="col-md-4">
                    <input type="number" name="inclus_ordres[]" class="form-control" value="{{ inclus.ordre }}" min="1">
                </div>
            </div>
        {% endfor %}
    </div>

    <button type="button" class="btn btn-success mb-3" onclick="addInclus()">+ Ajouter un √©l√©ment inclus</button>

    <hr>

    <!-- -------------------- NON INCLUS EXCURSION -------------------- -->
    <h4 class="mt-4">üî¥ Non inclus dans l'excursion</h4>

    <div id="zone-non-inclus">
        {% for non in non_inclus_list %}
            <div class="row mb-3">
                <div class="col-md-8">
                    <input type="text" name="non_inclus_items[]" class="form-control" value="{{ non.item }}">
                </div>
                <div class="col-md-4">
                    <input type="number" name="non_inclus_ordres[]" class="form-control" value="{{ non.ordre }}" min="1">
                </div>
            </div>
        {% endfor %}
    </div>

    <button type="button" class="btn btn-danger mb-3" onclick="addNonInclus()">+ Ajouter un √©l√©ment non inclus</button>

    <hr>

    <button type="submit" class="btn btn-primary">üíæ Mettre √† jour</button>

    </form>
</div>


<script>
function addInclus() {
    const zone = document.getElementById('zone-inclus');
    const html = `
        <div class="row mb-3">
            <div class="col-md-8">
                <input type="text" name="inclus_items[]" class="form-control" placeholder="√âl√©ment inclus...">
            </div>
            <div class="col-md-4">
                <input type="number" name="inclus_ordres[]" class="form-control" value="1" min="1">
            </div>
        </div>
    `;
    zone.insertAdjacentHTML('beforeend', html);
}

function addNonInclus() {
    const zone = document.getElementById('zone-non-inclus');
    const html = `
        <div class="row mb-3">
            <div class="col-md-8">
                <input type="text" name="non_inclus_items[]" class="form-control" placeholder="√âl√©ment non inclus...">
            </div>
            <div class="col-md-4">
                <input type="number" name="non_inclus_ordres[]" class="form-control" value="1" min="1">
            </div>
        </div>
    `;
    zone.insertAdjacentHTML('beforeend', html);
}
</script>

<script>
document.getElementById('titre').addEventListener('change', function () {
    const descriptionField = document.getElementById('description');

    if (this.value === "Aide") {
        descriptionField.value = 
`Si vous avez des questions sur cette visite ou besoin d'aide pour r√©server, 
nous nous ferons une joie de vous aider. 
Appelez-nous simplement au num√©ro 93312378.`;
    }
    else if (this.value === "Conditions d'annulation") {
        descriptionField.value =
`‚Ä¢ Pour recevoir un remboursement complet, vous devez annuler plus de 24 heures avant l'heure de d√©but de l'exp√©rience.
‚Ä¢ Si vous annulez moins de 24 heures avant l'heure de d√©but de l'exp√©rience, le montant que vous avez pay√© ne sera pas rembours√©.
‚Ä¢ Aucune modification effectu√©e moins de 24 heures avant l'heure de d√©but de l'exp√©rience ne sera accept√©e.
‚Ä¢ Pour avoir lieu, cette exp√©rience requiert un nombre minimum de voyageurs. Si elle est annul√©e car cette condition n'est pas remplie, nous vous proposerons une autre date/activit√© ou le remboursement complet.`;
    }
});
</script>

{% endblock %}
